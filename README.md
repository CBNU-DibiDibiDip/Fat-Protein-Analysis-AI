# Fat-Protein-Calculation-AI

### AI를 활용한 고기의 지방량과 단백질량 분석

## Background
- 최근 몇 년 사이 헬스나 몸관리에 관심을 가지는 인구가 급격하게 늘어나면서, 식단 관리에도 관심을 가지는 사람들이 늘어남
- 그러나, 대용량으로 고기를 구매할 시 제대로 된 지방량과 단백질량이 표기되어 있지 않은 경우가 많음
- 특히 고기를 소분해 놓는 경우, 지방량과 단백질량에 대한 추정이 더 힘들어짐

## Architecture
![pci2022-18-fig8](https://github.com/user-attachments/assets/cdb36bf6-4985-4123-b21e-81e83d307148)
- 첫 번째 U-Net 모델은 이미지에서 고기를 추출한다.
- 두 번째 U-Net 모델은 고기가 마스크된 이미지에서 지방을 추출한다.
- 이 후, 고기 마스크와 지방 마스크를 이용해 25cm의 눈금자를 스케일 마커로 사용하여 지방량과 단백질량을 계산한다.
## Dataset
- 인터넷에서 직접 'raw beef' 키워드에 대한 80개의 이미지를 수집하였다. (추후, 더 수집할 예정)
- 그 후 Labelme 도구를 이용해 고기에 대한 라벨링을 진행하였다.
- 지방에 대한 라벨링 같은 경우, 이미지를 흑백으로 변환 후, threshold 값을 사용(지방은 하얗다는 성질을 이용)하여 진행하였다.
- 인터넷에서 수집한 80개의 사진에 대해 flip, rotation과 같은 데이터 증강 기법을 이용하여, 총 560개의 이미지 데이터 셋으로 학습을 진행하였다.
- 수집한 데이터 셋에 대해 train set, valid set, test set을 0.7:0.15:0.15 비율로 나눠 모델을 훈련하고 검증하였다.
## Reference
- https://dl.acm.org/doi/fullHtml/10.1145/3575879.3575975#fig5
- https://arxiv.org/abs/1505.04597
- https://ieeexplore.ieee.org/document/4767851
